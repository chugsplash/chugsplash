# Getting Started in a New Repository

This guide will show you how to setup Sphinx's Foundry CLI plugin in a fresh repository. We'll create a sample project, then test and deploy it locally.

## Table of Contents

1. [Prerequisites](#1-prerequisites)
2. [Update Foundry](#2-update-foundry)
3. [Create a new directory](#3-create-a-new-directory)
4. [Install dependencies](#4-install-dependencies)
5. [Initialize a project](#5-initialize-a-project)
6. [Run tests](#6-run-tests)
7. [Broadcast a deployment on Anvil (optional)](#7-broadcast-a-deployment-on-anvil-optional)
8. [Next steps](#8-next-steps)

## 1. Prerequisites

The following must be installed on your machine:
- [Foundry](https://book.getfoundry.sh/getting-started/installation)
- [Yarn](https://classic.yarnpkg.com/lang/en/docs/install/), [npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm), or [pnpm](https://pnpm.io/installation)
- [Node Version >=16.16.0](https://nodejs.org/en/download)

You must also have a basic understanding of how to use Foundry and Forge scripts. Here are the relevant guides in the Foundry docs:
* [Getting Started with Foundry](https://book.getfoundry.sh/getting-started/first-steps)
* [Writing Deployment Scripts with Foundry](https://book.getfoundry.sh/tutorials/solidity-scripting)

## 2. Update Foundry

```
foundryup
```

## 3. Create a new directory

In your terminal, navigate to the directory where you'd like to create your project. Then, create a new directory:

```
mkdir hello_sphinx && cd hello_sphinx
```

## 4. Install dependencies

Install Sphinx, forge-std, and ds-test using your preferred package manager.

Yarn:
```
yarn add --dev @sphinx-labs/plugins https://github.com/foundry-rs/forge-std.git#v1.7.1 https://github.com/dapphub/ds-test.git#e282159d5170298eb2455a6c05280ab5a73a4ef0
```

npm:
```
npm install --save-dev @sphinx-labs/plugins https://github.com/foundry-rs/forge-std.git#v1.7.1 https://github.com/dapphub/ds-test.git#e282159d5170298eb2455a6c05280ab5a73a4ef0
```

pnpm:
```
pnpm add -D @sphinx-labs/plugins https://github.com/foundry-rs/forge-std.git#v1.7.1 https://github.com/dapphub/ds-test.git#e282159d5170298eb2455a6c05280ab5a73a4ef0
```

## 5. Initialize a project

### yarn or npm
```
npx sphinx init --quickstart
```

### pnpm
```
pnpm sphinx init --quickstart --pnpm
```

This command created a few files:
- `src/HelloSphinx.sol`: A sample contract to deploy.
- `test/HelloSphinx.t.sol`: A test file for the deployment.
- `script/HelloSphinx.s.sol`: A sample deployment script.
- `foundry.toml`: The Foundry config file, which contains a few settings that are needed to run Sphinx.
- `.env`: A sample `.env` file that contains a valid private key on Anvil.
- `.gitignore`: A sample `.gitignore` file that contains files and directories generated by Sphinx, Foundry, and Node.

## 6. Run tests

```
forge test
```

## 7. Broadcast a deployment on Anvil (optional)

Sphinx has its own CLI task for broadcasting deployments onto stand-alone networks. Its main purpose is to deploy contracts on Anvil, but you can use it on live networks too.

First, start an Anvil node:
```
anvil
```

Then, navigate to a new terminal window. Deploy using the command:

```
npx sphinx deploy ./script/HelloSphinx.s.sol --network anvil
```

You'll be shown a preview of your deployment and prompted to confirm. Any transactions that are broadcasted by Foundry will be included in the deployment.

Sphinx will automatically generate deployment artifacts, which are in the same format as [hardhat-deploy](https://github.com/wighawag/hardhat-deploy). When the deployment completes, you'll find the deployment artifacts written to `./deployments/anvil-31337.json`.

If you'd like to use this command to deploy on a live network, you can verify your contracts on block explorers using the `--verify` flag.

## 8. Next steps

If you'd like to try out the DevOps platform, see the [Sphinx DevOps Platform guide](https://github.com/sphinx-labs/sphinx/blob/main/docs/ops-getting-started.md).

If you'd like to learn more about writing deployment scripts with Sphinx, see the [Writing Deployment Scripts with Sphinx guide](https://github.com/sphinx-labs/sphinx/blob/main/docs/writing-scripts.md).
